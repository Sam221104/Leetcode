# Write your MySQL query statement below AVG in repeated
select p.product_id, ifnull(round(sum(uni.units*p.price)/sum(units),2),0) as average_price from prices p left join unitssold uni on p.product_id = uni.product_id and uni.purchase_date between p.start_date and p.end_date group by p.product_id